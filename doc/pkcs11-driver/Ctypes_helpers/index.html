<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Ctypes_helpers (pkcs11-driver.Ctypes_helpers)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../index.html">pkcs11-driver</a> &#x00BB; Ctypes_helpers</nav><h1>Module <code>Ctypes_helpers</code></h1></header><dl><dt class="spec type" id="type-ulong"><a href="#type-ulong" class="anchor"></a><code><span class="keyword">type</span> ulong</code><code> = Unsigned.ULong.t</code></dt></dl><div class="spec module" id="module-Reachable_ptr"><a href="#module-Reachable_ptr" class="anchor"></a><code><span class="keyword">module</span> <a href="Reachable_ptr/index.html">Reachable_ptr</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><dl><dt class="spec value" id="val-ptr_from_string"><a href="#val-ptr_from_string" class="anchor"></a><code><span class="keyword">val</span> ptr_from_string : string <span>&#45;&gt;</span> <span>char Ctypes.ptr</span></code></dt><dd><p><code>ptr_from_string s</code> allocates memory for a C string with length <code>String.length s</code> and content copied from <code>s</code>. The string is not <code>null</code> terminated.</p></dd></dl><dl><dt class="spec value" id="val-string_from_ptr"><a href="#val-string_from_ptr" class="anchor"></a><code><span class="keyword">val</span> string_from_ptr : <span>char Ctypes.ptr</span> <span>&#45;&gt;</span> <span>length:int</span> <span>&#45;&gt;</span> string</code></dt><dd><p><code>string_from_ptr</code> allocates an OCaml string.</p></dd></dl><dl><dt class="spec value" id="val-string_from_carray"><a href="#val-string_from_carray" class="anchor"></a><code><span class="keyword">val</span> string_from_carray : <span>char Ctypes.CArray.t</span> <span>&#45;&gt;</span> string</code></dt><dd><p><code>string_from_carray array</code> allocates a fresh OCaml string whose content are copied from <code>array</code>.</p></dd></dl><dl><dt class="spec value" id="val-carray_from_string"><a href="#val-carray_from_string" class="anchor"></a><code><span class="keyword">val</span> carray_from_string : string <span>&#45;&gt;</span> <span>char Ctypes.CArray.t</span></code></dt><dd><p><code>carray_from_string</code> allocates a fresh array, whose content is identical to the string <code>s</code>. The resulting C string is not null terminated.</p></dd></dl><dl><dt class="spec value" id="val-string_copy"><a href="#val-string_copy" class="anchor"></a><code><span class="keyword">val</span> string_copy : string <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <span>char Ctypes.ptr</span> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>string_copy str length ptr</code> copy the content of <code>str</code> into the <code>length</code> bytes of memory pointed to by <code>ptr</code>.</p></dd></dl><dl><dt class="spec value" id="val-make_string"><a href="#val-make_string" class="anchor"></a><code><span class="keyword">val</span> make_string : string <span>&#45;&gt;</span> <span><span class="type-var">'a</span> Ctypes.structure</span> <span>&#45;&gt;</span> <span><span>(Unsigned.ULong.t, <span><span class="type-var">'a</span> Ctypes.structure</span>)</span> Ctypes.field</span> <span>&#45;&gt;</span> <span><span>(<span><span class="type-var">'b</span> <a href="Reachable_ptr/index.html#type-t">Reachable_ptr.t</a></span>, <span><span class="type-var">'a</span> Ctypes.structure</span>)</span> Ctypes.field</span> <span>&#45;&gt;</span> unit</code></dt><dd><p>* Copy an OCaml string to a Ctypes struct. * * Parameters: * - str is the source string * - p is the structure * - lengthField is the field within that struct that holds then length * - dataField idem for data * - typ is the type of the data</p></dd></dl><dl><dt class="spec value" id="val-view_string"><a href="#val-view_string" class="anchor"></a><code><span class="keyword">val</span> view_string : <span><span class="type-var">'b</span> Ctypes.structure</span> <span>&#45;&gt;</span> <span><span>(<a href="index.html#type-ulong">ulong</a>, <span><span class="type-var">'b</span> Ctypes.structure</span>)</span> Ctypes.field</span> <span>&#45;&gt;</span> <span><span>(<span><span class="type-var">'a</span> <a href="Reachable_ptr/index.html#type-t">Reachable_ptr.t</a></span>, <span><span class="type-var">'b</span> Ctypes.structure</span>)</span> Ctypes.field</span> <span>&#45;&gt;</span> string</code></dt><dd><p>* Read an OCaml string from a Ctypes struct. * * Parameters: same as make_string.</p></dd></dl><dl><dt class="spec value" id="val-make_string_option"><a href="#val-make_string_option" class="anchor"></a><code><span class="keyword">val</span> make_string_option : <span>string option</span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span>, <span>[ `Struct ]</span>)</span> Ctypes.structured</span> <span>&#45;&gt;</span> <span><span>(Unsigned.ULong.t, <span><span>(<span class="type-var">'a</span>, <span>[ `Struct ]</span>)</span> Ctypes.structured</span>)</span> Ctypes.field</span> <span>&#45;&gt;</span> <span><span>(<span><span class="type-var">'b</span> <a href="Reachable_ptr/index.html#type-t">Reachable_ptr.t</a></span>, <span><span>(<span class="type-var">'a</span>, <span>[ `Struct ]</span>)</span> Ctypes.structured</span>)</span> Ctypes.field</span> <span>&#45;&gt;</span> unit</code></dt><dd><p>* Copy a string option to a pointer + length. * Copying None sets the pointer to NULL and length to 0. * Parameters are the same as make_string.</p></dd></dl><dl><dt class="spec value" id="val-view_string_option"><a href="#val-view_string_option" class="anchor"></a><code><span class="keyword">val</span> view_string_option : <span><span>(<span class="type-var">'a</span>, <span>[ `Struct ]</span>)</span> Ctypes.structured</span> <span>&#45;&gt;</span> <span><span>(<a href="index.html#type-ulong">ulong</a>, <span><span class="type-var">'a</span> Ctypes.structure</span>)</span> Ctypes.field</span> <span>&#45;&gt;</span> <span><span>(<span><span class="type-var">'b</span> <a href="Reachable_ptr/index.html#type-t">Reachable_ptr.t</a></span>, <span><span>(<span class="type-var">'a</span>, <span>[ `Struct ]</span>)</span> Ctypes.structured</span>)</span> Ctypes.field</span> <span>&#45;&gt;</span> <span>string option</span></code></dt><dd><p>* Make a string option out of a pointer + length. * Same semantics for copy as make_string_option. * Same arguments as view_string.</p></dd></dl><dl><dt class="spec exception" id="exception-Buffer_overflow"><a href="#exception-Buffer_overflow" class="anchor"></a><code><span class="keyword">exception</span> </code><code><span class="exception">Buffer_overflow</span></code></dt></dl><dl><dt class="spec value" id="val-blank_padded"><a href="#val-blank_padded" class="anchor"></a><code><span class="keyword">val</span> blank_padded : <span>length:int</span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> string</code></dt><dd><p>Pad a string with ' ' up to <code>length</code>. Raises <code>Buffer_overflow</code> if the string is too long.</p></dd></dl><dl><dt class="spec value" id="val-packed_field"><a href="#val-packed_field" class="anchor"></a><code><span class="keyword">val</span> packed_field : <span><span class="type-var">'t</span> Ctypes.typ</span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span><span class="type-var">'a</span> Ctypes.typ</span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span>, <span><span>(<span class="type-var">'s</span>, <span>[&lt; `Struct <span>| `Union</span> ]</span>)</span> Ctypes_static.structured</span> <span class="keyword">as</span> 't)</span> Ctypes.field</span></code></dt><dd><p>Like <code>Ctypes.field</code> except that it will always align to 1 byte.</p></dd></dl><dl><dt class="spec value" id="val-smart_field"><a href="#val-smart_field" class="anchor"></a><code><span class="keyword">val</span> smart_field : <span><span class="type-var">'t</span> Ctypes.typ</span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span><span class="type-var">'a</span> Ctypes.typ</span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span>, <span><span>(<span class="type-var">'s</span>, <span>[&lt; `Struct <span>| `Union</span> ]</span>)</span> Ctypes_static.structured</span> <span class="keyword">as</span> 't)</span> Ctypes.field</span></code></dt><dd><p>On unix, act like <code>Ctypes.field</code>. On windows, act like <code>packed_field</code>.</p></dd></dl><dl><dt class="spec value" id="val-with_out_fmt"><a href="#val-with_out_fmt" class="anchor"></a><code><span class="keyword">val</span> with_out_fmt : string <span>&#45;&gt;</span> <span>(Stdlib.Format.formatter <span>&#45;&gt;</span> <span class="type-var">'a</span>)</span> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p>Open a file for writing and returns a formatter to it.</p></dd></dl></div></body></html>